<header class="header">
  <div class="header__container">
    <div class="header__logo" (click)="goToDashboard()" [style.cursor]="isAuthenticated() ? 'pointer' : 'default'">
      <img 
        [src]="logoPath()" 
        alt="LA GRAVISTERIE" 
        class="header__logo-image"
        (load)="onLogoLoad()"
        (error)="onLogoError()"
        *ngIf="!showTextFallback()">
      <span class="header__logo-text" *ngIf="showTextFallback()">LA GRAVISTERIE</span>
    </div>
    <div class="header__actions">
      <div class="header__actions-auth" *ngIf="isAuthenticated()">
        <button 
          class="header__back-btn"
          *ngIf="showBackButton()"
          (click)="goBack()"
          type="button"
          title="Retour √† la page pr√©c√©dente">
          ‚Üê Retour
        </button>
        <div class="header__search" *ngIf="showSearchBar()">
          <button
            class="header__search-btn"
            type="button"
            title="Rechercher une commande"
            (click)="toggleSearch()">
            üîé
          </button>
        </div>
        <button 
          class="header__settings-btn"
          (click)="goToSettings()"
          type="button"
          title="Param√®tres">
          ‚öôÔ∏è
        </button>
        <button 
          class="header__logout-btn"
          (click)="logout()"
          type="button">
          Se d√©connecter
        </button>
      </div>
      <button 
        class="theme-toggle"
        (click)="toggleTheme()"
        type="button"
        [attr.aria-label]="isDarkMode() ? 'Passer au th√®me clair' : 'Passer au th√®me sombre'"
        title="Changer de th√®me">
        <svg class="sun-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" [style.display]="isDarkMode() ? 'none' : 'block'">
          <circle cx="12" cy="12" r="5"/>
          <line x1="12" y1="1" x2="12" y2="3"/>
          <line x1="12" y1="21" x2="12" y2="23"/>
          <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
          <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
          <line x1="1" y1="12" x2="3" y2="12"/>
          <line x1="21" y1="12" x2="23" y2="12"/>
          <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
          <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
        </svg>
        <svg class="moon-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" [style.display]="isDarkMode() ? 'block' : 'none'">
          <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
        </svg>
      </button>
    </div>
  </div>
</header>
<div class="header__search-overlay" *ngIf="searchOpen()">
  <div class="header__search-backdrop" (click)="toggleSearch()"></div>
  <div class="header__search-modal" role="dialog" aria-modal="true" aria-label="Recherche de commande">
    <div class="header__search-modal-header">
      <span class="header__search-modal-title">Rechercher une commande</span>
      <button class="header__search-close" type="button" (click)="toggleSearch()" aria-label="Fermer">
        ‚úï
      </button>
    </div>
    <div class="header__search-input">
      <input
        #searchInput
        type="search"
        class="header__search-field"
        placeholder="Rechercher une commande..."
        [value]="searchQuery()"
        (input)="onSearchInput($event)"
        (focus)="onSearchFocus()"
        (blur)="onSearchBlur()"
        (keydown.enter)="onSearchEnter($event)"
        aria-label="Rechercher une commande">
    </div>
    <div class="header__search-results" *ngIf="showSearchResults()">
      <div class="header__search-status" *ngIf="searchLoading()">Chargement des commandes...</div>
      <div class="header__search-status" *ngIf="!searchLoading() && searchQuery().trim().length < 2">
        Tapez au moins 2 caract√®res
      </div>
      <button
        type="button"
        class="header__search-item"
        *ngFor="let commande of filteredCommandes()"
        (mousedown)="onSelectCommande(commande)">
        <div class="header__search-item-head">
          <div class="header__search-item-title">{{ getCommandeTitle(commande) }}</div>
          <span class="header__search-status-pill" [ngClass]="getCommandeStatusClass(commande)">
            {{ getCommandeStatusLabel(commande) }}
          </span>
        </div>
        <div class="header__search-item-meta">
          {{ getCommandeClientLabel(commande) }} ‚Ä¢ {{ getCommandeDateLabel(commande) }}
          <span *ngIf="getCommandePriceLabel(commande)"> ‚Ä¢ {{ getCommandePriceLabel(commande) }}</span>
        </div>
      </button>
      <div class="header__search-status" *ngIf="!searchLoading() && searchQuery().trim().length >= 2 && filteredCommandes().length === 0">
        Aucune commande trouv√©e
      </div>
    </div>
  </div>
</div>
